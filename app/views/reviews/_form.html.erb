<%= form_with model: form_model, class: "mt-10 space-y-8" do |f| %>
  <% axes = [
    [:sweetness, t("reviews.form.axes.sweetness"), t("reviews.form.axis_options.sweetness")],
    [:richness, t("reviews.form.axes.richness"), t("reviews.form.axis_options.richness")],
    [:aftertaste, t("reviews.form.axes.aftertaste"), t("reviews.form.axis_options.aftertaste")],
    [:flavor_score, t("reviews.form.axes.flavor_score"), t("reviews.form.axis_options.flavor_score")],
    [:solubility, t("reviews.form.axes.solubility"), t("reviews.form.axis_options.solubility")],
    [:foam, t("reviews.form.axes.foam"), t("reviews.form.axis_options.foam")]
  ] %>
  <div class="rounded-2xl border border-base bg-stone-50 px-6 py-5">
    <div class="flex flex-wrap items-center gap-4">
      <span class="text-sm font-semibold text-stone-700"><%= t("reviews.form.overall_label") %></span>
      <div class="flex flex-row-reverse items-center gap-1">
        <% 5.downto(1) do |score| %>
          <%= radio_button_tag "review[overall_score]", score, review.overall_score.to_i == score,
            id: "review_overall_score_#{score}", class: "peer sr-only" %>
          <label for="review_overall_score_<%= score %>" class="cursor-pointer text-2xl text-stone-300 peer-checked:text-amber-400 peer-checked~label:text-amber-400">
            â˜…
          </label>
        <% end %>
      </div>
      <span id="overall-score-value" class="ml-auto text-sm font-semibold text-stone-700"></span>
    </div>
  </div>

  <div class="grid gap-6 md:grid-cols-[160px_1fr]">
    <p class="text-sm font-semibold text-stone-700"><%= t("reviews.form.title_label") %></p>
    <%= f.text_field :title, class: "w-full rounded-2xl border border-base bg-white px-4 py-3 text-sm text-main focus:border-brand focus:outline-none focus:ring-2 focus:ring-brand-light/30" %>
  </div>

  <div class="grid gap-6 md:grid-cols-[160px_1fr]">
    <p class="text-sm font-semibold text-stone-700"><%= t("reviews.form.comment_label") %></p>
    <%= f.text_area :comment, rows: 5, class: "w-full rounded-2xl border border-base bg-white px-4 py-3 text-sm text-main focus:border-brand focus:outline-none focus:ring-2 focus:ring-brand-light/30" %>
  </div>

  <div class="grid gap-6 md:grid-cols-[160px_1fr]">
    <div>
      <p class="text-sm font-semibold text-stone-700"><%= t("reviews.form.tags_label") %></p>
      <p class="mt-1 text-xs text-stone-400"><%= t("reviews.form.tags_hint") %></p>
    </div>
    <%= f.text_field :tag_names,
      value: review.tag_names,
      placeholder: t("reviews.form.tags_placeholder"),
      class: "w-full rounded-2xl border border-base bg-white px-4 py-3 text-sm text-main focus:border-brand focus:outline-none focus:ring-2 focus:ring-brand-light/30",
      data: { controller: "tagify", tagify_url_value: autocomplete_tags_path, tagify_mode_value: "tags" } %>
  </div>

  <div class="space-y-6">
    <h3 class="text-lg font-semibold text-stone-900"><%= t("reviews.form.axis_title") %></h3>
    <% axes.each do |field, label, labels| %>
      <% l1, l2, l3, l4, l5 = labels %>
      <div class="grid gap-3 md:grid-cols-[140px_1fr] md:items-start">
        <div class="text-sm font-semibold text-stone-700 md:pt-2"><%= label %></div>
        <div class="w-full">
          <%= f.range_field field, in: 1..5, step: 1, value: f.object.public_send(field) || 3,
            class: "rating-range w-full h-2 rounded-full bg-stone-200 appearance-none cursor-pointer" %>
          <div class="relative mt-2 min-h-8 text-[10px] leading-tight text-stone-400 sm:text-xs">
            <span class="absolute left-0 text-left"><%= l1 %></span>
            <span class="absolute left-1/4 -translate-x-1/2 text-center hidden sm:inline"><%= l2 %></span>
            <span class="absolute left-1/2 -translate-x-1/2 text-center"><%= l3 %></span>
            <span class="absolute left-3/4 -translate-x-1/2 text-center hidden sm:inline"><%= l4 %></span>
            <span class="absolute right-0 text-right"><%= l5 %></span>
          </div>
        </div>
      </div>
    <% end %>
  </div>

  <div class="flex flex-col items-stretch gap-3 pt-4 sm:flex-row sm:justify-center">
    <%= f.submit t("reviews.form.submit"), class: "btn-primary w-full rounded-full px-8 py-2 sm:w-auto" %>
    <%= link_to t("reviews.form.cancel"), cancel_path, class: "w-full rounded-full border border-base px-6 py-2 text-center text-sm font-semibold text-stone-600 hover:border-stone-300 sm:w-auto" %>
  </div>
<% end %>
