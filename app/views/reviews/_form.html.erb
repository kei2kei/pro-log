<%= form_with model: form_model, class: "mt-10 space-y-8" do |f| %>
  <div class="rounded-2xl border border-base bg-stone-50 px-6 py-5">
    <div class="flex flex-wrap items-center gap-4">
      <span class="text-sm font-semibold text-stone-700">総合満足度</span>
      <div class="flex flex-row-reverse items-center gap-1">
        <% 5.downto(1) do |score| %>
          <%= radio_button_tag "review[overall_score]", score, review.overall_score.to_i == score,
            id: "review_overall_score_#{score}", class: "peer sr-only" %>
          <label for="review_overall_score_<%= score %>" class="cursor-pointer text-2xl text-stone-300 peer-checked:text-amber-400 peer-checked~label:text-amber-400">
            ★
          </label>
        <% end %>
      </div>
      <span id="overall-score-value" class="ml-auto text-sm font-semibold text-stone-700"></span>
    </div>
  </div>

  <div class="grid gap-6 md:grid-cols-[160px_1fr]">
    <p class="text-sm font-semibold text-stone-700">レビュータイトル</p>
    <%= f.text_field :title, class: "w-full rounded-2xl border border-base bg-white px-4 py-3 text-sm text-main focus:border-brand focus:outline-none focus:ring-2 focus:ring-brand-light/30" %>
  </div>

  <div class="grid gap-6 md:grid-cols-[160px_1fr]">
    <p class="text-sm font-semibold text-stone-700">レビュー内容</p>
    <%= f.text_area :comment, rows: 5, class: "w-full rounded-2xl border border-base bg-white px-4 py-3 text-sm text-main focus:border-brand focus:outline-none focus:ring-2 focus:ring-brand-light/30" %>
  </div>

  <div class="grid gap-6 md:grid-cols-[160px_1fr]">
    <div>
      <p class="text-sm font-semibold text-stone-700">タグ</p>
      <p class="mt-1 text-xs text-stone-400">カンマ・スペース区切りで入力</p>
    </div>
    <%= f.text_field :tag_names,
      value: review.tag_names,
      placeholder: "例: チョコ, 甘め など",
      class: "w-full rounded-2xl border border-base bg-white px-4 py-3 text-sm text-main focus:border-brand focus:outline-none focus:ring-2 focus:ring-brand-light/30",
      data: { controller: "tagify", tagify_url_value: autocomplete_tags_path, tagify_mode_value: "tags" } %>
  </div>

  <div class="space-y-6">
    <h3 class="text-lg font-semibold text-stone-900">各項目の評価</h3>
    <% [
      [:sweetness, "甘さ", ["甘くない", "やや甘くない", "普通", "やや甘め", "甘め"]],
      [:richness, "濃さ", ["薄め", "やや薄め", "普通", "やや濃いめ", "濃いめ"]],
      [:aftertaste, "後味", ["スッキリ", "ややスッキリ", "普通", "やや重め", "重い"]],
      [:flavor_score, "風味", ["香りはしない", "香り控えめ", "普通", "やや香り豊か", "香り豊か"]],
      [:solubility, "溶けやすさ", ["溶けにくい", "やや溶けにくい", "普通", "やや溶けやすい", "溶けやすい"]],
      [:foam, "泡立ち", ["泡立ちにくい", "やや泡立ちにくい", "普通", "やや泡立つ", "泡立つ"]]
    ].each do |field, label, labels| %>
      <% l1, l2, l3, l4, l5 = labels %>
      <div class="grid gap-3 md:grid-cols-[140px_1fr] md:items-start">
        <div class="text-sm font-semibold text-stone-700 md:pt-2"><%= label %></div>
        <div class="w-full">
          <%= f.range_field field, in: 1..5, step: 1, value: f.object.public_send(field) || 3,
            class: "rating-range w-full h-2 rounded-full bg-stone-200 appearance-none cursor-pointer" %>
          <div class="mt-2 grid grid-cols-5 text-[10px] leading-tight text-stone-400 sm:text-xs">
            <span class="text-left"><%= l1 %></span>
            <span class="text-center"><%= l2 %></span>
            <span class="text-center"><%= l3 %></span>
            <span class="text-center"><%= l4 %></span>
            <span class="text-right"><%= l5 %></span>
          </div>
        </div>
      </div>
    <% end %>
  </div>

  <div class="flex flex-col items-stretch gap-3 pt-4 sm:flex-row sm:justify-center">
    <%= f.submit "送信", class: "btn-primary w-full rounded-full px-8 py-2 sm:w-auto" %>
    <%= link_to "キャンセル", cancel_path, class: "w-full rounded-full border border-base px-6 py-2 text-center text-sm font-semibold text-stone-600 hover:border-stone-300 sm:w-auto" %>
  </div>
<% end %>
