<%= form_with model: form_model, class: "mt-10 space-y-8" do |f| %>
  <div class="rounded-2xl border border-base bg-stone-50 px-6 py-5">
    <div class="flex flex-wrap items-center gap-4">
      <span class="text-sm font-semibold text-stone-700">総合満足度</span>
      <div class="flex flex-row-reverse items-center gap-1">
        <% 5.downto(1) do |score| %>
          <%= radio_button_tag "review[overall_score]", score, review.overall_score.to_i == score,
            id: "review_overall_score_#{score}", class: "peer sr-only" %>
          <label for="review_overall_score_<%= score %>" class="cursor-pointer text-2xl text-stone-300 peer-checked:text-amber-400 peer-checked~label:text-amber-400">
            ★
          </label>
        <% end %>
      </div>
      <span id="overall-score-value" class="ml-auto text-sm font-semibold text-stone-700"></span>
    </div>
  </div>

  <div class="grid gap-6 md:grid-cols-[160px_1fr]">
    <p class="text-sm font-semibold text-stone-700">レビュータイトル</p>
    <%= f.text_field :title, class: "w-full rounded-2xl border border-base bg-white px-4 py-3 text-sm text-main focus:border-brand focus:outline-none focus:ring-2 focus:ring-brand-light/30" %>
  </div>

  <div class="grid gap-6 md:grid-cols-[160px_1fr]">
    <p class="text-sm font-semibold text-stone-700">レビュー内容</p>
    <%= f.text_area :comment, rows: 5, class: "w-full rounded-2xl border border-base bg-white px-4 py-3 text-sm text-main focus:border-brand focus:outline-none focus:ring-2 focus:ring-brand-light/30" %>
  </div>

  <div class="grid gap-6 md:grid-cols-[160px_1fr]">
    <div>
      <p class="text-sm font-semibold text-stone-700">タグ</p>
      <p class="mt-1 text-xs text-stone-400">カンマ・スペース区切りで入力</p>
    </div>
    <%= f.text_field :tag_names, value: review.tag_names, placeholder: "例: チョコ, 甘め など", class: "w-full rounded-2xl border border-base bg-white px-4 py-3 text-sm text-main focus:border-brand focus:outline-none focus:ring-2 focus:ring-brand-light/30" %>
  </div>

  <div class="space-y-6">
    <h3 class="text-lg font-semibold text-stone-900">各項目の評価</h3>
    <% [
      [:sweetness, "甘さ", ["甘め", "やや甘め", "普通", "やや甘くない", "甘くない"]],
      [:richness, "濃さ", ["濃いめ", "やや濃いめ", "普通", "やや薄め", "薄め"]],
      [:aftertaste, "後味", ["重い", "やや重め", "普通", "ややスッキリ", "スッキリ"]],
      [:flavor_score, "風味", ["香り豊か", "やや香り豊か", "普通", "香り控えめ", "香りはしない"]],
      [:solubility, "溶けやすさ", ["溶けやすい", "やや溶けやすい", "普通", "やや溶けにくい", "溶けにくい"]],
      [:foam, "泡立ち", ["泡立つ", "やや泡立つ", "普通", "やや泡立ちにくい", "泡立ちにくい"]]
    ].each do |field, label, labels| %>
      <% l1, l2, l3, l4, l5 = labels %>
      <div class="grid gap-4 md:grid-cols-[140px_1fr] md:items-start">
        <div class="pt-3 text-sm font-semibold text-stone-700"><%= label %></div>
        <div class="relative w-full pb-7">
          <%= f.range_field field, in: 1..5, step: 1, value: f.object.public_send(field) || 3,
            class: "rating-range w-full h-2 rounded-full bg-stone-200 appearance-none cursor-pointer" %>
          <span class="absolute left-0 top-5 text-[10px] text-stone-400 md:text-xs"><%= l1 %></span>
          <span class="absolute left-1/4 top-5 -translate-x-1/2 text-[10px] text-stone-400 md:text-xs"><%= l2 %></span>
          <span class="absolute left-1/2 top-5 -translate-x-1/2 text-[10px] text-stone-400 md:text-xs"><%= l3 %></span>
          <span class="absolute left-3/4 top-5 -translate-x-1/2 text-[10px] text-stone-400 md:text-xs"><%= l4 %></span>
          <span class="absolute right-0 top-5 text-[10px] text-stone-400 md:text-xs"><%= l5 %></span>
        </div>
      </div>
    <% end %>
  </div>

  <div class="flex justify-center gap-3 pt-4">
    <%= link_to "キャンセル", cancel_path, class: "rounded-full border border-base px-6 py-2 text-sm font-semibold text-stone-600 hover:border-stone-300" %>
    <%= f.submit "送信", class: "btn-primary rounded-full px-8 py-2" %>
  </div>
<% end %>
